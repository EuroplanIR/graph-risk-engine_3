<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Предикторы для PD модели в Европлане от ИИ - Интерактивная таблица</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 95vw;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            padding: 30px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .module-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 20px;
        }

        .module-filter {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .module-filter:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .module-filter.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .module-filter.inactive {
            background: #94a3b8;
            box-shadow: 0 2px 8px rgba(148, 163, 184, 0.2);
        }

        .search-box {
            display: none;
        }

        .table-container {
            overflow-x: auto;
            max-height: 70vh;
            border-radius: 0 0 20px 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 13px;
        }

        thead {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            white-space: nowrap;
            min-width: 120px;
        }

        th:last-child {
            border-right: none;
        }

        tbody tr {
            transition: all 0.3s ease;
            border-bottom: 1px solid #f1f5f9;
        }

        tbody tr:hover {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            transform: scale(1.001);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        tbody tr.hidden {
            display: none;
        }

        td {
            padding: 12px 8px;
            vertical-align: top;
            border-right: 1px solid #f1f5f9;
            font-size: 12px;
            line-height: 1.4;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        td:last-child {
            border-right: none;
        }

        .number-cell {
            font-weight: 700;
            color: #4f46e5;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-width: 50px;
            max-width: 50px;
        }

        .module-cell {
            font-weight: 600;
            color: #1f2937;
            background: rgba(79, 70, 229, 0.05);
            border-left: 4px solid #4f46e5;
            min-width: 180px;
            max-width: 180px;
        }

        .factor-cell {
            font-weight: 500;
            color: #374151;
            min-width: 250px;
            max-width: 300px;
        }

        .variable-cell {
            font-family: 'Courier New', monospace;
            background: #f8fafc;
            color: #7c3aed;
            font-weight: 500;
            min-width: 150px;
            max-width: 150px;
        }

        .data-type-cell {
            font-weight: 500;
            padding: 8px 12px;
        }

        .continuous {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1d4ed8;
            border-radius: 6px;
        }

        .categorical {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
            border-radius: 6px;
        }

        .discrete {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            color: #166534;
            border-radius: 6px;
        }

        .binary {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            color: #9d174d;
            border-radius: 6px;
        }

        .formula-cell {
            font-family: 'Courier New', monospace;
            background: #f9fafb;
            color: #059669;
            font-size: 13px;
        }

        .range-cell {
            color: #4b5563;
            font-weight: 500;
        }

        .threshold-cell {
            font-weight: 600;
            color: #dc2626;
        }

        .stats {
            padding: 20px 30px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .stat-number {
            font-weight: 700;
            font-size: 18px;
            color: #4f46e5;
        }

        .stat-label {
            color: #6b7280;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .controls {
                padding: 20px;
            }

            .module-filters {
                gap: 8px;
            }

            .module-filter {
                padding: 10px 16px;
                font-size: 14px;
            }

            th, td {
                padding: 12px 8px;
                font-size: 13px;
            }

            .stats {
                padding: 15px 20px;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6b7280;
            font-style: italic;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>Предикторы для PD модели в Европлане от ИИ</h1>
        <p>Интерактивная таблица факторов и переменных</p>
    </div>

    <div class="controls">
        <div class="module-filters" id="moduleFilters">
            <!-- Модули будут добавлены динамически -->
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
            <tr>
                <th>№</th>
                <th>Модуль</th>
                <th>Фактор</th>
                <th>Переменная (англ.)</th>
                <th>Тип данных</th>
                <th>Формула расчета</th>
                <th>Ожидаемый диапазон</th>
                <th>Критические пороги</th>
            </tr>
            </thead>
            <tbody id="tableBody">
            <tr class="loading">
                <td colspan="8">Загрузка данных...</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="stats">
        <div class="stat-item">
            <span class="stat-number" id="totalCount">0</span>
            <span class="stat-label">всего записей</span>
        </div>
        <div class="stat-item">
            <span class="stat-number" id="visibleCount">0</span>
            <span class="stat-label">отображается</span>
        </div>
        <div class="stat-item">
            <span class="stat-number" id="moduleCount">0</span>
            <span class="stat-label">активных модулей</span>
        </div>
    </div>
</div>

<script>
        // Точные данные из Excel файла
        const predictorsData = [
            {number: 1, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Срок экспозиции ПЛ при изъятии (дни)", variable: "pl_liquidation_days", dataType: "Непрерывная", formula: "ML ", expectedRange: "1-365 дней", criticalThresholds: ">180: низкая ликвидность"},
            {number: 2, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Потеря стоимости / амортизация ПЛ (% в год)", variable: "pl_depreciation_rate", dataType: "Непрерывная", formula: "ML ", expectedRange: "5-50%", criticalThresholds: ">40%: быстрое обесценение"},
            {number: 3, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Тип предмета лизинга (для ТС и оборудования)", variable: "pl_type", dataType: "Категориальная", formula: "СПРАВОЧНИК(Код_типа_ПЛ)", expectedRange: "типы ТС и оборудования", criticalThresholds: "Только справочные значения"},
            {number: 4, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Региональный коэффициент эксплуатации (удаленность)", variable: "pl_region_risk", dataType: "Категориальная", formula: "СПРАВОЧНИК_РЕГИОНОВ(Код_региона_эксплуатации)", expectedRange: "коды регионов", criticalThresholds: "Только справочные значения"},
            {number: 5, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Стоимость ПЛ (млн руб.)", variable: "pl_cost_mln", dataType: "Непрерывная", formula: "Стоимость_ПЛ / 1000000", expectedRange: "0.1-200 млн", criticalThresholds: ">200: проверить корректность"},
            {number: 6, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Возраст ПЛ на момент сделки - мес. (новый бу)", variable: "pl_age_months", dataType: "Непрерывная", formula: "РАЗНОСТЬ(Дата_заключения, Дата_выпуска_ПЛ) / 30.44", expectedRange: "0-120 мес", criticalThresholds: ">120: очень старый"},
            {number: 7, module: "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)", factor: "Остаточная стоимость ПЛ (%)", variable: "pl_residual_value_pct", dataType: "Непрерывная", formula: "(Остаточная_стоимость / Первоначальная_стоимость) * 100", expectedRange: "10-95%", criticalThresholds: ">50% медленное выгашивание"},
            {number: 8, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Количество платежей в Европлан за 12 мес.", variable: "hist_payments_12m", dataType: "Дискретная", formula: "СЧЕТ(Платежи WHERE Дата >= -12_месяцев AND Клиент_ID = X)", expectedRange: "0-12", criticalThresholds: "0: новый клиент"},
            {number: 9, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Доля невыплаченного долга в историческом портфеле (%)", variable: "ltv", dataType: "Непрерывная", formula: "(Остаток_долга_невершенных / Первоначальная_стоимость_незавершенных) * 100", expectedRange: "0-100%", criticalThresholds: ">90% свежий портфель"},
            {number: 10, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Количество просрочек 15+ дней за 12 мес.", variable: "overdue_15plus_count", dataType: "Дискретная", formula: "СЧЕТ(Просрочки WHERE Дни >= 15 AND Дата >= -12_месяцев)", expectedRange: "0-100", criticalThresholds: ">10: проблемная дисциплина"},
            {number: 11, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Количество просрочек 30+ дней за 12 мес.", variable: "overdue_30plus_count", dataType: "Дискретная", formula: "СЧЕТ(Просрочки WHERE Дни >= 30 AND Дата >= -12_месяцев)", expectedRange: "0-80", criticalThresholds: ">5: высокий риск"},
            {number: 12, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Количество просрочек 60+ дней за 12 мес.", variable: "overdue_60plus_count", dataType: "Дискретная", formula: "СЧЕТ(Просрочки WHERE Дни >= 60 AND Дата >= -12_месяцев)", expectedRange: "0-60", criticalThresholds: ">2: критический риск"},
            {number: 13, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Количество просрочек 90+ дней за 12 мес.", variable: "overdue_90plus_count", dataType: "Дискретная", formula: "СЧЕТ(Просрочки WHERE Дни >= 90 AND Дата >= -12_месяцев)", expectedRange: "0-10", criticalThresholds: ">0: стоп-фактор"},
            {number: 14, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Активные кредиты/лизинги (ЕФРС)", variable: "external_credits_active", dataType: "Дискретная", formula: "API_ЕФРС(ИНН).активные_кредиты + активные_лизинги", expectedRange: "0-500", criticalThresholds: ">500: перекредитованность"},
            {number: 15, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Неплановые завершения (ЕФРС)", variable: "external_defaults_count", dataType: "Дискретная", formula: "API_ЕФРС(ИНН).неплановые_завершения", expectedRange: "0-100", criticalThresholds: ">5: внимание"},
            {number: 16, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Завершенные договоры в Европлан", variable: "hist_contracts_completed", dataType: "Дискретная", formula: "СЧЕТ(Договоры WHERE Статус = 'Завершен' AND Клиент_ID = X)", expectedRange: "0-100", criticalThresholds: "0: новый клиент"},
            {number: 17, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Средняя просрочка за 12 мес. (дни)", variable: "avg_overdue_days", dataType: "Непрерывная", formula: "СРЕДНЕЕ(Просрочка_дней WHERE Дата >= -12_месяцев)", expectedRange: "0-90 дней", criticalThresholds: ">30: плохая дисциплина"},
            {number: 18, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Тренд платежной дисциплины", variable: "payment_discipline_trend", dataType: "Категориальная", formula: "ЕСЛИ(Просрочка_6м < Просрочка_12м, 1, ЕСЛИ(=, 0, -1))", expectedRange: "-1,0,1", criticalThresholds: "-1: ухудшение"},
            {number: 19, module: "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)", factor: "Дефолты связанных компаний", variable: "related_parties_defaults", dataType: "Бинарная", formula: "СЧЕТ(Связанные_лица WHERE Дефолт = 1) > 0", expectedRange: "0,1", criticalThresholds: "1: риск заражения"},
            {number: 20, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Размер аванса (или отношение к медиане за год)", variable: "advance_payment", dataType: "Непрерывная", formula: "(Сумма_аванса / Стоимость_ПЛ) * 100", expectedRange: "0-0.49", criticalThresholds: "<0.05"},
            {number: 21, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Процентная ставка (или отношение к средней)", variable: "interest_rate", dataType: "Непрерывная", formula: "(Ставка/СРЕДНЕЕ_по_категории)", expectedRange: "8-35% или 0.5-2.0", criticalThresholds: ">40% или >2.5: аномалия"},
            {number: 22, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Срок лизинга (месяцы)", variable: "lease_term_months", dataType: "Дискретная", formula: "Срок_лизинга_месяцев", expectedRange: "6-120 мес", criticalThresholds: ">84: долгосрочный риск"},
            {number: 23, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Количество дополнительных услуг", variable: "additional_services_count", dataType: "Дискретная", formula: "СЧЕТ(Доп_услуги WHERE Договор_ID = X)", expectedRange: "0-20", criticalThresholds: ">10: нетипично"},
            {number: 24, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Рисковая цель использования ПЛ (такси / новое направление)", variable: "risky_purpose_flag", dataType: "Категориальная", formula: "СПРАВОЧНИК_РИСКОВЫХ_ЦЕЛЕЙ(Код_цели)", expectedRange: "0,1,2,3", criticalThresholds: ">0: повышенный риск"},
            {number: 25, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Признак возвратного лизинга", variable: "buyback_lease_flag", dataType: "Бинарная", formula: "ЕСЛИ(Тип_лизинга = 'Возвратный', 1, 0)", expectedRange: "0,1", criticalThresholds: "1: особый контроль"},
            {number: 26, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Тип платежного графика", variable: "payment_schedule_type", dataType: "Категориальная", formula: "СПРАВОЧНИК_ТИПОВ_ГРАФИКОВ(Код)", expectedRange: "1,2,3,4", criticalThresholds: "3,4: нестандартные"},
            {number: 27, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Наличие GPS/ГЛОНАСС системы", variable: "satellite_system_flag", dataType: "Бинарная", formula: "ЕСЛИ(Спутниковая_система = 1, 1, 0)", expectedRange: "0,1", criticalThresholds: "0: снижает контроль"},
            {number: 28, module: "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)", factor: "Чистая инвестиция (млн руб.)", variable: "net_investment_mln", dataType: "Непрерывная", formula: "(Стоимость_ПЛ - Аванс + НДС + Комиссии) / 1000000", expectedRange: "0.05-1000 млн", criticalThresholds: ">50: крупная сделка"},
            {number: 29, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Категория клиента по размеру", variable: "client_size_category", dataType: "Категориальная", formula: "СПРАВОЧНИК_КАТЕГОРИЙ(Выручка)", expectedRange: "1,2,3,4", criticalThresholds: "-"},
            {number: 30, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Отношение РСИ к лимиту в CRM", variable: "investment_to_limit_ratio", dataType: "Непрерывная", formula: "Активные_инвестиции / Лимит_CRM", expectedRange: "0-2.0", criticalThresholds: ">1.0: превышение лимита"},
            {number: 31, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Отношение РСИ к годовой выручке", variable: "investment_to_revenue_ratio", dataType: "Непрерывная", formula: "Активные_инвестиции / Годовая_выручка", expectedRange: "0-2.0", criticalThresholds: ">0.25: высокая концентрация"},
            {number: 32, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Отношение РСИ к внеоборотным активам", variable: "investment_to_assets_ratio", dataType: "Непрерывная", formula: "Активные_инвестиции / Внеоборотные_активы", expectedRange: "0-3.0", criticalThresholds: ">1: высокая доля"},
            {number: 33, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Отношение РСИ к собственному капиталу", variable: "investment_to_equity_ratio", dataType: "Непрерывная", formula: "Активные_инвестиции / Собственный_капитал", expectedRange: "0-10.0", criticalThresholds: ">1.0: критический леверидж"},
            {number: 34, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Коэффициент текущей ликвидности", variable: "current_liquidity_ratio", dataType: "Непрерывная", formula: "Оборотные_активы / Краткосрочные_обязательства", expectedRange: "0-10.0", criticalThresholds: "<1.0: проблемы с ликвидностью"},
            {number: 35, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Рентабельность продаж (%)", variable: "net_profit_margin_pct", dataType: "Непрерывная", formula: "(Чистая_прибыль / Выручка) * 100", expectedRange: "-100% до +50%", criticalThresholds: "<-10%: серьезные убытки"},
            {number: 36, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Долговая нагрузка к выручке", variable: "debt_to_revenue_ratio", dataType: "Непрерывная", formula: "(Долгосрочные_обязательства + Краткосрочные_кредиты) / Выручка", expectedRange: "0-5.0", criticalThresholds: ">2.0: критическая нагрузка"},
            {number: 37, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Темп роста выручки", variable: "revenue_growth_rate", dataType: "Непрерывная", formula: "Выручка_текущий / Выручка_прошлый", expectedRange: "0-5.0", criticalThresholds: "<0.5: сильное падение"},
            {number: 38, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Концентрация клиентской базы (HHI)", variable: "client_concentration_hhi", dataType: "Непрерывная", formula: "СУММА((Выручка_клиента_i / Общая_выручка)^2)", expectedRange: "0-1.0", criticalThresholds: ">0.5: критическая концентрация"},
            {number: 39, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Загрузка автопарка (%)", variable: "fleet_utilization_rate", dataType: "Непрерывная", formula: "Работающие_ТС / Общее_количество_ТС * 100", expectedRange: "0-100%", criticalThresholds: "<80%: низкая эффективность"},
            {number: 40, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Доля собственного автопарка (%)", variable: "own_fleet_share_pct", dataType: "Непрерывная", formula: "(Собственные_ТС / Общий_парк) * 100", expectedRange: "0-100%", criticalThresholds: ">20%: высокая эффективность"},
            {number: 41, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Активность покупки автотранспорта за 12 мес", variable: "vehicle_purchase_activity", dataType: "Дискретная", formula: "СЧЕТ(Покупки_ТС за 12_месяцев WHERE ЮЛ = 1)", expectedRange: "0-2000", criticalThresholds: ">100: очень активный"},
            {number: 42, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Годовая выручка (млн руб.)", variable: "annual_revenue_mln", dataType: "Непрерывная", formula: "Выручка_за_год / 1000000", expectedRange: "0.1-50000 млн", criticalThresholds: ">10000: мегакорпорация"},
            {number: 43, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Общие активы (млн руб.)", variable: "total_assets_mln", dataType: "Непрерывная", formula: "(Внеоборотные + Оборотные_активы) / 1000000", expectedRange: "0.05-100000 млн", criticalThresholds: ">50000: мегакорпорация"},
            {number: 44, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Собственный капитал (млн руб.)", variable: "equity_capital_mln", dataType: "Непрерывная", formula: "(Уставный + Нераспределенная_прибыль + Резервы) / 1000000", expectedRange: "-1000 до +10000 млн", criticalThresholds: "<0: отрицательный СК"},
            {number: 45, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Рентабельность активов (%)", variable: "return_on_assets_pct", dataType: "Непрерывная", formula: "(Чистая_прибыль / Общие_активы) * 100", expectedRange: "-50% до +100%", criticalThresholds: "<-20%: серьезные проблемы"},
            {number: 46, module: "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)", factor: "Z-скор Альтмана (модифицированный)", variable: "altman_z_score", dataType: "Непрерывная", formula: "1.2*(Об_капитал/Активы) + 1.4*(Нераспр_прибыль/Активы) + 3.3*(EBIT/Активы) + 0.6*(Капитал/Обязательства)", expectedRange: "-5.0 до +15.0", criticalThresholds: "<1.8: зона банкротства"},
            {number: 47, module: "АРБИТРАЖНЫЕ ДЕЛА (3 фактора)", factor: "Количество активных дел (истец)", variable: "arbitrage_cases_count", dataType: "Дискретная", formula: "API_КАРТОТЕКА_АРБИТРАЖЕЙ(ИНН).активные_истец", expectedRange: "0-100", criticalThresholds: ">20: высокая конфликтность"},
            {number: 48, module: "АРБИТРАЖНЫЕ ДЕЛА (3 фактора)", factor: "Доля арбитражных сумм в выручке (%)", variable: "arbitrage_sum_to_revenue_pct", dataType: "Непрерывная", formula: "(Общая_сумма_исков / Годовая_выручка) * 100", expectedRange: "0-200%", criticalThresholds: ">20%: критическая доля"},
            {number: 49, module: "АРБИТРАЖНЫЕ ДЕЛА (3 фактора)", factor: "Динамика арбитражных сумм", variable: "arbitrage_sum_dynamics", dataType: "Непрерывная", formula: "Сумма_исков_тек_год / Сумма_исков_прош_год", expectedRange: "0-10.0", criticalThresholds: ">3.0: резкий рост конфликтов"},
            {number: 50, module: "ИСПОЛНИТЕЛЬНЫЕ ПРОИЗВОДСТВА (2 фактора)", factor: "Количество активных производств", variable: "fssp_cases_count", dataType: "Дискретная", formula: "API_ФССП(ИНН).активные_производства", expectedRange: "0-50", criticalThresholds: ">10: серьезные проблемы"},
            {number: 51, module: "ИСПОЛНИТЕЛЬНЫЕ ПРОИЗВОДСТВА (2 фактора)", factor: "Доля долгов ФССП в выручке (%)", variable: "fssp_debt_to_revenue_pct", dataType: "Непрерывная", formula: "(Общая_сумма_долгов_ФССП / Годовая_выручка) * 100", expectedRange: "0-100%", criticalThresholds: ">25%: критическая задолженность"},
            {number: 52, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Возраст компании (месяцы)", variable: "company_age_months", dataType: "Непрерывная", formula: "РАЗНОСТЬ(СЕГОДНЯ(), Дата_регистрации) / 30.44", expectedRange: "1-600 мес", criticalThresholds: "<6: очень молодая"},
            {number: 53, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Стаж руководителя (месяцы)", variable: "ceo_tenure_months", dataType: "Непрерывная", formula: "РАЗНОСТЬ(СЕГОДНЯ(), Дата_назначения_ГД) / 30.44", expectedRange: "0-480 мес", criticalThresholds: "<3: новый руководитель"},
            {number: 54, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Стабильность участников (месяцы)", variable: "ownership_stability_months", dataType: "Непрерывная", formula: "РАЗНОСТЬ(СЕГОДНЯ(), Последнее_изменение_участников) / 30.44", expectedRange: "0-360 мес", criticalThresholds: "<6: недавние изменения"},
            {number: 55, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Отраслевой код (ОКВЭД)", variable: "industry_okved_code", dataType: "Категориальная", formula: "ПЕРВЫЕ_2_СИМВОЛА(Основной_ОКВЭД)", expectedRange: "коды отраслей", criticalThresholds: "-"},
            {number: 56, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Сектор экономики", variable: "business_sector_type", dataType: "Категориальная", formula: "СПРАВОЧНИК_СЕКТОРОВ(Основной_ОКВЭД)", expectedRange: "1,2,3,4", criticalThresholds: "-"},
            {number: 57, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Регион регистрации", variable: "registration_region_code", dataType: "Категориальная", formula: "СПРАВОЧНИК_РЕГИОНОВ(Код_региона)", expectedRange: "01-99", criticalThresholds: "-"},
            {number: 58, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Организационно-правовая форма", variable: "legal_form_type", dataType: "Категориальная", formula: "СПРАВОЧНИК_ОПФ(Код_ОПФ)", expectedRange: "коды ОПФ", criticalThresholds: "-"},
            {number: 59, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Налоговый режим", variable: "tax_regime_type", dataType: "Категориальная", formula: "API_ФНС(ИНН).налоговый_режим", expectedRange: "1,2,3,4", criticalThresholds: "-"},
            {number: 60, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Отраслевой риск-скор", variable: "industry_risk_score", dataType: "Категориальная", formula: "СПРАВОЧНИК_ОТРАСЛЕВЫХ_РИСКОВ(ОКВЭД)", expectedRange: "1,2,3,4,5", criticalThresholds: "4,5: высокорисковые отрасли"},
            {number: 61, module: "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)", factor: "Экономический индекс региона", variable: "region_economic_index", dataType: "Категориальная", formula: "СПРАВОЧНИК_ЭКОНОМИКИ_РЕГИОНОВ(Код_региона)", expectedRange: "1,2,3,4,5", criticalThresholds: "4,5: депрессивные регионы"},
            {number: 62, module: "СТОП-ФАКТОРЫ (4 фактора)", factor: "Намерение о банкротстве", variable: "bankruptcy_intention_flag", dataType: "Бинарная", formula: "API_КАРТОТЕКА_БАНКРОТСТВ(ИНН).намерение > 0", expectedRange: "0,1", criticalThresholds: "1: стоп-фактор"},
            {number: 63, module: "СТОП-ФАКТОРЫ (4 фактора)", factor: "Иск о банкротстве", variable: "bankruptcy_lawsuit_flag", dataType: "Бинарная", formula: "API_КАРТОТЕКА_БАНКРОТСТВ(ИНН).иск > 0", expectedRange: "0,1", criticalThresholds: "1: стоп-фактор"},
            {number: 64, module: "СТОП-ФАКТОРЫ (4 фактора)", factor: "Статус в черных списках", variable: "blacklist_status_flag", dataType: "Бинарная", formula: "API_РОСФИНМОНИТОРИНГ(ИНН) OR API_ДИСКВАЛИФИКАЦИЯ(ИНН)", expectedRange: "0,1", criticalThresholds: "1: стоп-фактор"},
            {number: 65, module: "СТОП-ФАКТОРЫ (4 фактора)", factor: "Связи с санкционными лицами", variable: "sanctions_connection_level", dataType: "Категориальная", formula: "API_САНКЦИИ(ИНН).связи + ПРОВЕРКА_УЧАСТНИКОВ()", expectedRange: "0,1,2", criticalThresholds: ">0: повышенный контроль"},
            {number: 66, module: "ТЕНДЕРНАЯ АКТИВНОСТЬ (3 фактора)", factor: "Количество выигранных тендеров за 12 мес.", variable: "tenders_won_count", dataType: "Дискретная", formula: "API_ЗАКУПКИ_ГОВ(ИНН).выигранные_за_12м", expectedRange: "0-500", criticalThresholds: ">200: очень активный"},
            {number: 67, module: "ТЕНДЕРНАЯ АКТИВНОСТЬ (3 фактора)", factor: "Сумма выигранных тендеров (млн руб.)", variable: "tender_revenue_mln", dataType: "Непрерывная", formula: "API_ЗАКУПКИ_ГОВ(ИНН).сумма_выигранных_12м / 1000000", expectedRange: "0-10000 млн", criticalThresholds: ">1000: мегаконтракты"},
            {number: 68, module: "ТЕНДЕРНАЯ АКТИВНОСТЬ (3 фактора)", factor: "Доля тендерной выручки (%)", variable: "tender_revenue_share_pct", dataType: "Непрерывная", formula: "(Сумма_тендеров / Годовая_выручка) * 100", expectedRange: "0-100%", criticalThresholds: ">80%: критическая зависимость"},
            {number: 69, module: "МАКРОЭКОНОМИЧЕСКИЕ ФАКТОРЫ (4 факторов)", factor: "Уровень инфляции (%)", variable: "inflation_rate_pct", dataType: "Непрерывная", formula: "API_ЦБ_РФ().инфляция_текущий_месяц", expectedRange: "0-30%", criticalThresholds: ">15%: высокая инфляция"},
            {number: 70, module: "МАКРОЭКОНОМИЧЕСКИЕ ФАКТОРЫ (4 факторов)", factor: "Мультипликатор ключевой ставки", variable: "key_rate_multiplier", dataType: "Непрерывная", formula: "(КС_текущая - КС_нормальная) * Чувствительность_отрасли", expectedRange: "-10.0 до +10.0", criticalThresholds: ">5.0: жесткая ДКП"},
            {number: 71, module: "МАКРОЭКОНОМИЧЕСКИЕ ФАКТОРЫ (4 факторов)", factor: "Ключевая ставка ЦБ (%)", variable: "key_rate_pct", dataType: "Непрерывная", formula: "API_ЦБ_РФ().ключевая_ставка", expectedRange: "0-30%", criticalThresholds: ">25%: экстремально высокая"},
            {number: 72, module: "МАКРОЭКОНОМИЧЕСКИЕ ФАКТОРЫ (4 факторов)", factor: "Региональный уровень дефолтов (%)", variable: "regional_default_rate_pct", dataType: "Непрерывная", formula: "СТАТИСТИКА_ДЕФОЛТОВ(Регион, Отрасль, 12м)", expectedRange: "0-50%", criticalThresholds: ">20%: кризисный регион"}
        ];

        const modules = [
            "ХАРАКТЕРИСТИКИ ПЛ (7 факторов)",
            "КРЕДИТНАЯ ИСТОРИЯ (12 факторов)",
            "УСЛОВИЯ ДОГОВОРА ЛИЗИНГА (9 факторов)",
            "ФИНАНСОВОЕ СОСТОЯНИЕ / МАСШТАБ (18 факторов)",
            "АРБИТРАЖНЫЕ ДЕЛА (3 фактора)",
            "ИСПОЛНИТЕЛЬНЫЕ ПРОИЗВОДСТВА (2 фактора)",
            "ХАРАКТЕРИСТИКИ КЛИЕНТА / ЕГРЮЛ (10 факторов)",
            "СТОП-ФАКТОРЫ (4 фактора)",
            "ТЕНДЕРНАЯ АКТИВНОСТЬ (3 фактора)",
            "МАКРОЭКОНОМИЧЕСКИЕ ФАКТОРЫ (4 факторов)"
        ];

        let activeModules = new Set(modules);
        let filteredData = [...predictorsData];

        // Инициализация
        function init() {
            createModuleFilters();
            renderTable();
            setupEventListeners();
            updateStats();
        }

        // Создание кнопок модулей
        function createModuleFilters() {
            const container = document.getElementById('moduleFilters');

            modules.forEach(module => {
                const button = document.createElement('button');
                button.className = 'module-filter active';
                button.textContent = module;
                button.onclick = () => toggleModule(module, button);
                container.appendChild(button);
            });
        }

        // Переключение модуля
        function toggleModule(module, button) {
            if (activeModules.has(module)) {
                activeModules.delete(module);
                button.classList.remove('active');
                button.classList.add('inactive');
            } else {
                activeModules.add(module);
                button.classList.remove('inactive');
                button.classList.add('active');
            }

            filterData();
        }

        // Фильтрация данных
        function filterData() {
            filteredData = predictorsData.filter(item => {
                const matchesModule = activeModules.has(item.module);
                return matchesModule;
            });

            renderTable();
            updateStats();
        }

        // Получение CSS класса для типа данных
        function getDataTypeClass(dataType) {
            switch(dataType) {
                case 'Непрерывная': return 'continuous';
                case 'Категориальная': return 'categorical';
                case 'Дискретная': return 'discrete';
                case 'Бинарная': return 'binary';
                default: return 'continuous';
            }
        }

        // Отрисовка таблицы
        function renderTable() {
            const tbody = document.getElementById('tableBody');

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr class="no-results"><td colspan="8">Нет данных для отображения</td></tr>';
                return;
            }

            tbody.innerHTML = filteredData.map(item => `
                <tr>
                    <td class="number-cell">${item.number}</td>
                    <td class="module-cell">${item.module}</td>
                    <td class="factor-cell">${item.factor}</td>
                    <td class="variable-cell">${item.variable}</td>
                    <td class="data-type-cell ${getDataTypeClass(item.dataType)}">${item.dataType}</td>
                    <td class="formula-cell">${item.formula}</td>
                    <td class="range-cell">${item.expectedRange}</td>
                    <td class="threshold-cell">${item.criticalThresholds}</td>
                </tr>
            `).join('');
        }

        // Обновление статистики
        function updateStats() {
            document.getElementById('totalCount').textContent = predictorsData.length;
            document.getElementById('visibleCount').textContent = filteredData.length;
            document.getElementById('moduleCount').textContent = activeModules.size;
        }

        // Обработчики событий
        function setupEventListeners() {
            // Удалены обработчики поиска
        }

        // Запуск приложения
        init();
    </script>
</body>
</html>